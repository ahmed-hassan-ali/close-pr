name: List Open PRs

on:
  schedule:
    - cron: "* * * * *"  # Runs every minute

jobs:
  list-open-prs:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Verify GitHub CLI Installation
        run: |
          if ! command -v gh &> /dev/null
          then
            echo "GitHub CLI not found, installing..."
            sudo apt-get update
            sudo apt-get install -y gh
          else
            echo "GitHub CLI is already installed."
          fi
          gh --version  # Check GH CLI version

      - name: List Open PRs with Creation Date
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "Listing all open PRs and their creation dates:"
          gh pr list --state open --json number,title,createdAt \
            --jq '.[] | "\(.number): \(.title) - Created at: \(.createdAt)"'
